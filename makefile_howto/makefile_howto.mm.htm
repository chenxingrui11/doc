<html xmlns="http://www.w3.org/1999/xhtml"><!--This file has been created with freemind2html.xsl--><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Makefile Howto</title><link rel="stylesheet" href="/stylesheets/master.css" type="text/css"></link><link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css"></link><link rel="stylesheet" href="/docbook/includes/css/freemind2html.css" type="text/css"></link><link rel="stylesheet" href="/docbook/includes/css/docbook.css" type="text/css"></link><meta name="generator" content="FreeMind-XSL Stylesheet (see: http://freemind-xsl.dev.slash-me.net/ for details)"></meta><script type="text/javascript"><!--
          
               function toggle(id)
               {
                   div_el = document.getElementById(id);
                   img_el = document.getElementById('img'+id);
                   if (div_el.style.display != 'none')
                   {
          
					
                      div_el.style.display='none';
                      img_el.src = '/docbook/includes/images/freemind/show.png';
          
                   }
                   else
                   {
          
                      div_el.style.display='block';
                      img_el.src = '/docbook/includes/images/freemind/hide.png';
          
                   };
               };
          
	--></script></head><body><script type="text/javascript" src="/docbook/includes/js/header.js"></script><script type="text/javascript">
	  write_header("/docbook");
	</script><h1>Makefile Howto</h1><script type="text/javascript" src="/docbook/includes/mmflash/mmflash.js"></script><style type="text/css">
		#flashcontent {
			height: 100%;
		}
	</style><script type="text/javascript"><!--

		var hasReqestedVersion = DetectFlashVer(7, 0, 19);
		if (hasReqestedVersion) {
			FlashObject(

				"movie", "/docbook/includes/mmflash/visorFreemind.swf",

				"width", "100%",
				"height", "500",
				"align", "middle",
				"quality", "high",
				"bgcolor", "#FFFFFF",
				"id", "visorFreeMind",
				"name", "visorFreeMind",
				"openUrl", "_blank",

				"initLoadFile", "makefile_howto.mm",

				"startCollapsedToLevel", "5",
				'codebase', 'http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab#version=7,0,19,0',
				"pluginspage", "http://www.adobe.com/go/getflashplayer"
			);
		} else {
			var alternateContent = '<div id="flashcontent">'
			+ 'This content requires the Adobe Flash Player. <br/>'
			+ 'Flash Plugin version 7.0 or higher is needed. '
			+ '<a href="http://www.adobe.com/go/getflashplayer/">Get Flash</a>'
			+ '</div>';
			document.write(alternateContent);
		}

		--></script><noscript><div id="flashcontent">
			Flash plugin or Javascript are turned off.
			Activate both and reload to view the mindmap.<br></br><a href="http://www.adobe.com/go/getflash/">Get Flash</a></div></noscript><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp1520")' id="imgidp1520"></img><a id="FMFreemind_Link_1431891543FM"></a><div class="nodecontent">Makefile Howto</div><div class="content" id="idp1520"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp2336")' id="imgidp2336"></img><a id="FMFreemind_Link_910196632FM"></a><div class="nodecontent">入门</div><div class="content" id="idp2336"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp3360")' id="imgidp3360"></img><a id="FMFreemind_Link_678023707FM"></a><div class="nodecontent">Why called Makefile</div><div class="content" id="idp3360"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_798852186FM"></a><div class="nodecontent">make 命令依次查找如下文件  `GNUmakefile', `makefile' and `Makefile'</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1108820418FM"></a><div class="nodecontent">GNUmakefile 可能不被非 gnu 的 make 识别</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_818796043FM"></a><div class="nodecontent">之所以用 Makefile，因为显示文件列表排在最前</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp6528")' id="imgidp6528"></img><a id="FMFreemind_Link_934019834FM"></a><div class="nodecontent">Makefile 规则介绍</div><div class="content" id="idp6528"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1650081473FM"></a><div class="nodecontent"> target ... : prerequisites ...<br></br>        command<br></br>        ...</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_638579396FM"></a><div class="nodecontent">命令前面是一个 Tab 制表符，而不是空格！</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_581364213FM"></a><div class="nodecontent">目标和依赖都可以是多个</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1310476143FM"></a><div class="nodecontent">依赖也可以为空。例如 clean 不需要依赖任何文件</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1318069725FM"></a><div class="nodecontent">依赖可以决定 target 是否 outofdate，命令告诉如何生成 target</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp11104")' id="imgidp11104"></img><a id="FMFreemind_Link_1947240579FM"></a><div class="nodecontent">变量</div><div class="content" id="idp11104"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp12032")' id="imgidp12032"></img><a id="FMFreemind_Link_1304048960FM"></a><div class="nodecontent">变量定义，如：</div><div class="content" id="idp12032"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_421066226FM"></a><div class="nodecontent">objects = main.o kbd.o command.o display.o \<br></br>          insert.o search.o files.o utils.o<br></br>
</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_808684421FM"></a><div class="nodecontent">变量引用，如：$(objects)</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1781219115FM"></a><div class="nodecontent">如果要显示 $ 字符，则可以 $$</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp15424")' id="imgidp15424"></img><a id="FMFreemind_Link_1190546999FM"></a><div class="nodecontent">示例</div><div class="content" id="idp15424"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1429853225FM"></a><div class="nodecontent"> objects = main.o kbd.o command.o display.o \<br></br>          insert.o search.o files.o utils.o<br></br><br></br>edit : $(objects)<br></br>        cc -o edit $(objects)<br></br><br></br>$(objects) : defs.h<br></br>kbd.o command.o files.o : command.h<br></br>display.o insert.o search.o files.o : buffer.h<br></br><br></br> .PHONY : clean<br></br>clean :<br></br>        -rm edit $(objects)</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp17904")' id="imgidp17904"></img><a id="FMFreemind_Link_1996671203FM"></a><div class="nodecontent">进阶</div><div class="content" id="idp17904"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp18928")' id="imgidp18928"></img><a id="FMFreemind_Link_980301528FM"></a><div class="nodecontent">Makefile 的五大要素</div><div class="content" id="idp18928"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1016155821FM"></a><div class="nodecontent">显示规则</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1674255780FM"></a><div class="nodecontent">隐含规则</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1951638169FM"></a><div class="nodecontent">变量定义</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_217306196FM"></a><div class="nodecontent">指令</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1249136184FM"></a><div class="nodecontent">注视</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp23408")' id="imgidp23408"></img><a id="FMFreemind_Link_1743082410FM"></a><div class="nodecontent">5-1. 显示规则</div><div class="content" id="idp23408"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_39372801FM"></a><div class="nodecontent">指定目标以及该目标的依赖，以及生成目标文件的命令</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp25120")' id="imgidp25120"></img><a id="FMFreemind_Link_981390483FM"></a><div class="nodecontent">格式</div><div class="content" id="idp25120"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp26048")' id="imgidp26048"></img><a id="FMFreemind_Link_101086756FM"></a><div class="nodecontent">命令另起一行，首字符是 tab</div><div class="content" id="idp26048"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_872936815FM"></a><div class="nodecontent"> target ... : prerequisites ...<br></br>        command<br></br>        ...</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp27872")' id="imgidp27872"></img><a id="FMFreemind_Link_971497395FM"></a><div class="nodecontent">命令可以和 依赖处于同一行，分号隔开</div><div class="content" id="idp27872"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_518221838FM"></a><div class="nodecontent">targets : prerequisites ; command<br></br>        command<br></br>        ...</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp29888")' id="imgidp29888"></img><a id="FMFreemind_Link_1922706868FM"></a><div class="nodecontent">依赖</div><div class="content" id="idp29888"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp30816")' id="imgidp30816"></img><a id="FMFreemind_Link_1137583917FM"></a><div class="nodecontent">normal prerequisites </div><div class="content" id="idp30816"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_762895811FM"></a><div class="nodecontent">作用1：指定编译顺序，先执行依赖本身的编译，之后再执行目标的编译</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_911269465FM"></a><div class="nodecontent">作用2：确定依赖关系，根据依赖文件于目标文件的时间戳对比，确认是否 outofdate</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp33600")' id="imgidp33600"></img><a id="FMFreemind_Link_714228224FM"></a><div class="nodecontent">order-only prerequisites</div> <a onclick="getVisibleParents('FMFreemind_Link_1150923028FM')" href="#FMFreemind_Link_1150923028FM"><img src="/docbook/includes/images/freemind/ilink.png" class="ilink" alt="Arrow Link"></img></a><div class="content" id="idp33600"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1281506018FM"></a><div class="nodecontent">格式：targets : normal-prerequisites | order-only-prerequisites<br></br>即用竖线分隔开普通依赖和顺序依赖</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1236624748FM"></a><div class="nodecontent">顺序依赖只起到前述的作用1，而不会影响 target 的 update 状态</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp37744")' id="imgidp37744"></img><a id="FMFreemind_Link_1955539478FM"></a><div class="nodecontent">也不会影响自动变量 $^  等</div><div class="content" id="idp37744"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp38576")' id="imgidp38576"></img><a id="FMFreemind_Link_366020681FM"></a><div class="nodecontent">例如 DocBook Makefile</div><div class="content" id="idp38576"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_785076123FM"></a><div class="nodecontent">autolayout.xml: layout.xml | docbook.test</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp40592")' id="imgidp40592"></img><a id="FMFreemind_Link_1150923028FM"></a><div class="nodecontent">测试一下</div><div class="content" id="idp40592"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_538227266FM"></a><div class="nodecontent">test : 1.xxx 2.xxx | 3.xxx<br></br>	@echo "test depends: $^"<br></br>%.xxx :<br></br>	@echo "now make target: $@"<br></br><br></br>执行 make -n test 将显示<br></br><br></br>echo "now make target: 1.xxx"<br></br>echo "now make target: 2.xxx"<br></br>echo "now make target: 3.xxx"<br></br>echo "test depends: 1.xxx 2.xxx"</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp43152")' id="imgidp43152"></img><a id="FMFreemind_Link_1532269422FM"></a><div class="nodecontent">5-2. 隐含规则</div><div class="content" id="idp43152"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp43952")' id="imgidp43952"></img><a id="FMFreemind_Link_1956578597FM"></a><div class="nodecontent">built-in 隐含规则</div><div class="content" id="idp43952"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp44784")' id="imgidp44784"></img><a id="FMFreemind_Link_93792663FM"></a><div class="nodecontent">隐含的 C 规则</div><div class="content" id="idp44784"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1609298549FM"></a><div class="nodecontent">*.c 文件生成 *.o 文件，使用命令 $(CC) -c $(CPPFLAGS) $(CFLAGS)</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp46624")' id="imgidp46624"></img><a id="FMFreemind_Link_954637615FM"></a><div class="nodecontent">隐含的 C++ 规则</div><div class="content" id="idp46624"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_340384372FM"></a><div class="nodecontent">*.cc/*.C 文件生成 *.o 文件，使用命令 $(CXX) -c $(CPPFLAGS) $(CXXFLAGS)</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp48480")' id="imgidp48480"></img><a id="FMFreemind_Link_1549110961FM"></a><div class="nodecontent">隐含的 Pascal 规则</div><div class="content" id="idp48480"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1186746886FM"></a><div class="nodecontent">*.p 文件生成 *.o 文件，使用命令 $(PC) -c $(PFLAGS)</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp50304")' id="imgidp50304"></img><a id="FMFreemind_Link_1139878027FM"></a><div class="nodecontent">链接目标文件规则</div><div class="content" id="idp50304"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_720806729FM"></a><div class="nodecontent">将目标文件 *.o 链接为可执行文件，命令: $(CC) $(LDFLAGS) *.o $(LOADLIBES) $(LDLIBS)</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp52528")' id="imgidp52528"></img><a id="FMFreemind_Link_264175333FM"></a><div class="nodecontent">自定义模式规则（Pattern Rules ）</div><div class="content" id="idp52528"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp53328")' id="imgidp53328"></img><a id="FMFreemind_Link_91182661FM"></a><div class="nodecontent">例如</div><div class="content" id="idp53328"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1394821087FM"></a><div class="nodecontent">  %.o : %.c<br></br>        $(CC) -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_29248870FM"></a><div class="nodecontent">  % :: RCS/%,v<br></br>        $(CO) $(COFLAGS) $&lt;</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1676467242FM"></a><div class="nodecontent">%.tab.c %.tab.h: %.y<br></br>        bison -d $&lt;</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_96030000FM"></a><div class="nodecontent">自定义的模式规则，可以替代自带的隐含规则</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp58336")' id="imgidp58336"></img><a id="FMFreemind_Link_583108190FM"></a><div class="nodecontent">5-3. 变量定义</div><div class="content" id="idp58336"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp59344")' id="imgidp59344"></img><a id="FMFreemind_Link_90813049FM"></a><div class="nodecontent">变量</div><div class="content" id="idp59344"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_827990075FM"></a><div class="nodecontent">大小写敏感</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp61216")' id="imgidp61216"></img><a id="FMFreemind_Link_1929955754FM"></a><div class="nodecontent">变量定义的<br></br>几种风格</div><div class="content" id="idp61216"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp62224")' id="imgidp62224"></img><a id="FMFreemind_Link_1541454135FM"></a><div class="nodecontent">风格1: 递归扩展变量<br></br>（recursively expanded variable）</div><div class="content" id="idp62224"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_826004040FM"></a><div class="nodecontent">变量定义格式是，变量和值之间用等号，即 =</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp64064")' id="imgidp64064"></img><a id="FMFreemind_Link_1348743050FM"></a><div class="nodecontent">例如：</div><div class="content" id="idp64064"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp65056")' id="imgidp65056"></img><a id="FMFreemind_Link_399018714FM"></a><div class="nodecontent"><br></br>foo = $(bar)<br></br>bar = $(ugh)<br></br>ugh = Huh?<br></br>all:;echo $(foo)<br></br>
</div><div class="content" id="idp65056"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_37929262FM"></a><div class="nodecontent">将显示  Huh?</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp67104")' id="imgidp67104"></img><a id="FMFreemind_Link_1564442216FM"></a><div class="nodecontent">再例如:</div><div class="content" id="idp67104"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1604731632FM"></a><div class="nodecontent">CFLAGS = $(include_dirs) -O<br></br>include_dirs = -Ifoo -Ibar
</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_562636169FM"></a><div class="nodecontent">缺点是不能这么定义：CFLAGS = $(CFLAGS) -O  ，将会死循环</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp69968")' id="imgidp69968"></img><a id="FMFreemind_Link_617211483FM"></a><div class="nodecontent">风格2: 简单扩展变量<br></br>（simply expanded variables）</div><div class="content" id="idp69968"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1435293478FM"></a><div class="nodecontent">变量定义格式是，变量和值之间用冒号等号，即 :=</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp71824")' id="imgidp71824"></img><a id="FMFreemind_Link_668388604FM"></a><div class="nodecontent">例如</div><div class="content" id="idp71824"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_145684666FM"></a><div class="nodecontent">x := foo<br></br>y := $(x) bar<br></br>x := later<br></br><br></br>等价于:<br></br><br></br>y := foo bar<br></br>x := later</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp73888")' id="imgidp73888"></img><a id="FMFreemind_Link_333920967FM"></a><div class="nodecontent">另外 ?= 含义为：没有定义则赋值</div><div class="content" id="idp73888"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1141688710FM"></a><div class="nodecontent"> FOO ?= bar<br></br><br></br>等价于<br></br><br></br>ifeq ($(origin FOO), undefined)<br></br>  FOO = bar<br></br>endif</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_467248351FM"></a><div class="nodecontent">+= 是为变量后面追加字符</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp76768")' id="imgidp76768"></img><a id="FMFreemind_Link_1654157743FM"></a><div class="nodecontent">变量替换</div> <a onclick="getVisibleParents('FMFreemind_Link_592325206FM')" href="#FMFreemind_Link_592325206FM"><img src="/docbook/includes/images/freemind/ilink.png" class="ilink" alt="Arrow Link"></img></a><div class="content" id="idp76768"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp79488")' id="imgidp79488"></img><a id="FMFreemind_Link_600835395FM"></a><div class="nodecontent">$(var:a=b)，是将 var 变量中每一个单词后面的 a 替换为 b</div><div class="content" id="idp79488"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_140974031FM"></a><div class="nodecontent">$(var:suffix=replacement)<br></br><br></br>等价于<br></br><br></br>$(patsubst %suffix,%replacement,$(var))</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp81488")' id="imgidp81488"></img><a id="FMFreemind_Link_1963856452FM"></a><div class="nodecontent">$(foo:%.o=%.c) ，由于出现了 %， 其功能和 patsubst 等价</div><div class="content" id="idp81488"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1877916484FM"></a><div class="nodecontent">$(var:pattern=replacement)<br></br><br></br>等价于<br></br><br></br>$(patsubst pattern,replacement,$(var))
</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp83616")' id="imgidp83616"></img><a id="FMFreemind_Link_251846050FM"></a><div class="nodecontent">变量计算</div><div class="content" id="idp83616"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1227824980FM"></a><div class="nodecontent">$($(var))</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp85360")' id="imgidp85360"></img><a id="FMFreemind_Link_115219766FM"></a><div class="nodecontent">如</div><div class="content" id="idp85360"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_147609558FM"></a><div class="nodecontent">x = $(y)<br></br>y = z<br></br>z = Hello<br></br>a := $($(x))</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_482082097FM"></a><div class="nodecontent">x = y<br></br>y = z<br></br>z = u<br></br>a := $($($(x)))</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp88176")' id="imgidp88176"></img><a id="FMFreemind_Link_298094380FM"></a><div class="nodecontent">通配符变量</div><div class="content" id="idp88176"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_389370957FM"></a><div class="nodecontent">如果在变量定义中使用通配符，objects = *.o  ，并不能展开通配符，*.o 被当做3个字符的字符串</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1858450495FM"></a><div class="nodecontent">如下格式定义：  objects := $(wildcard *.o)  </div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_963311304FM"></a><div class="nodecontent">使用函数，将 .c 文件转换为 .o 文件： $(patsubst %.c,%.o,$(wildcard *.c))   </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp91792")' id="imgidp91792"></img><a id="FMFreemind_Link_851026436FM"></a><div class="nodecontent">自动变量</div><div class="content" id="idp91792"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp92784")' id="imgidp92784"></img><a id="FMFreemind_Link_1361751790FM"></a><div class="nodecontent">$@</div><div class="content" id="idp92784"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1056836539FM"></a><div class="nodecontent">目标文件。当目标文件有多个，$@是触发规则的那个目标文件</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_329128851FM"></a><div class="nodecontent">当目标文件是 archive member，$@是 archive file，$% 是member name</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp95568")' id="imgidp95568"></img><a id="FMFreemind_Link_560279619FM"></a><div class="nodecontent">$%</div><div class="content" id="idp95568"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1415817607FM"></a><div class="nodecontent">当目标文件是 archive member，$@是 archive file，$% 是member name</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1930948656FM"></a><div class="nodecontent">例如 目标若是 foo.a(bar.o)，则 $%是 bar.o，$@是 foo.a</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp98336")' id="imgidp98336"></img><a id="FMFreemind_Link_231530995FM"></a><div class="nodecontent">$&lt;</div><div class="content" id="idp98336"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1117192211FM"></a><div class="nodecontent">第一个依赖文件</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp100224")' id="imgidp100224"></img><a id="FMFreemind_Link_340770908FM"></a><div class="nodecontent">$?</div><div class="content" id="idp100224"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_990800466FM"></a><div class="nodecontent">比目标文件新的所有依赖文件，文件之间用空格分开</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1934181871FM"></a><div class="nodecontent">当依赖文件是 archive members，$? 是 member name</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp102944")' id="imgidp102944"></img><a id="FMFreemind_Link_1620144742FM"></a><div class="nodecontent">$^</div><div class="content" id="idp102944"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1291635677FM"></a><div class="nodecontent">所有依赖文件（包括比目标旧的依赖文件），文件之间用空格分开</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1670430963FM"></a><div class="nodecontent">当依赖文件是 archive members，$? 是 member name</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_210958766FM"></a><div class="nodecontent">当一个文件在依赖列表中被罗列多次， $^ 只包含一次</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp106496")' id="imgidp106496"></img><a id="FMFreemind_Link_661531194FM"></a><div class="nodecontent">$＋</div><div class="content" id="idp106496"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1838576073FM"></a><div class="nodecontent">很 $^ 类似。</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1844292309FM"></a><div class="nodecontent">当一个文件在依赖列表中被罗列多次， $+ 不同于 $^，包含多个</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp109216")' id="imgidp109216"></img><a id="FMFreemind_Link_1681297264FM"></a><div class="nodecontent">$*</div><div class="content" id="idp109216"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_507584333FM"></a><div class="nodecontent">Patterns Match 中和目标文件匹配的部分</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_115505635FM"></a><div class="nodecontent">如: 目标为 `dir/a.foo.b' 并且目标表达式为 `a.%.b，则 $* 返回匹配的部分： `dir/foo'</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp112192")' id="imgidp112192"></img><a id="FMFreemind_Link_1460724235FM"></a><div class="nodecontent">$(@D), $(@F), $(*D), $(*F), <br></br>$(%D), $(%F), $(&lt;D), $(&lt;F), <br></br>$(^D), $(^F), $(+D), $(+F), <br></br>$(?D), $(?F)</div><div class="content" id="idp112192"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1798627322FM"></a><div class="nodecontent">分别标识上述变量中的目录部分(D)，或者文件部分 (F)</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_4604589FM"></a><div class="nodecontent">目录部分最后的 /，被删除</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_911600504FM"></a><div class="nodecontent">如 `$(@F)' 等价于 `$(notdir $@)'.</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp115824")' id="imgidp115824"></img><a id="FMFreemind_Link_460218445FM"></a><div class="nodecontent">5-4. 指令</div><div class="content" id="idp115824"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp116816")' id="imgidp116816"></img><a id="FMFreemind_Link_1553923301FM"></a><div class="nodecontent">include</div><div class="content" id="idp116816"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_584049936FM"></a><div class="nodecontent">包含其它文件</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1638325533FM"></a><div class="nodecontent">-include 含义为，如果被包含文件不存在，不报错</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp119504")' id="imgidp119504"></img><a id="FMFreemind_Link_623471748FM"></a><div class="nodecontent">条件判断</div><div class="content" id="idp119504"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp120496")' id="imgidp120496"></img><a id="FMFreemind_Link_1095902535FM"></a><div class="nodecontent">ifeq(var1, var2) ... else ... endif</div><div class="content" id="idp120496"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_167685193FM"></a><div class="nodecontent">如果 var1, va2 相等</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_33561439FM"></a><div class="nodecontent">ifeq ($(CC),gcc)<br></br>        $(CC) -o foo $(objects) $(libs_for_gcc)<br></br>else<br></br>        $(CC) -o foo $(objects) $(normal_libs)<br></br>endif
</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp123504")' id="imgidp123504"></img><a id="FMFreemind_Link_134808365FM"></a><div class="nodecontent">ifneq "var1" "var2" ... else ... endif</div><div class="content" id="idp123504"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1851003943FM"></a><div class="nodecontent">如果 var1, var2 不相等</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp125200")' id="imgidp125200"></img><a id="FMFreemind_Link_1573131738FM"></a><div class="nodecontent">ifdef var ... else ... endif</div><div class="content" id="idp125200"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1533653849FM"></a><div class="nodecontent">如果 var 不为空</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp126976")' id="imgidp126976"></img><a id="FMFreemind_Link_1917891263FM"></a><div class="nodecontent">例如</div><div class="content" id="idp126976"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_398424108FM"></a><div class="nodecontent">ifdef XML_CATALOG_FILES<br></br>ENSURE_XSL = <br></br>else<br></br>ENSURE_XSL = if ! test -e "$(TOOLS_DIR)/xsl"; \<br></br>	     then $(TOOLS_DIR)/bin/find-xsl.py; fi<br></br>endif
</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_623023984FM"></a><div class="nodecontent">ifndef variable-name</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp130240")' id="imgidp130240"></img><a id="FMFreemind_Link_675282788FM"></a><div class="nodecontent">定义包含多行文本的变量</div><div class="content" id="idp130240"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp131120")' id="imgidp131120"></img><a id="FMFreemind_Link_1880407380FM"></a><div class="nodecontent">例如下面的指令，定义了包含两条 echo 命令的变量 two-lines</div><div class="content" id="idp131120"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_370945549FM"></a><div class="nodecontent">define two-lines<br></br>echo foo<br></br>echo $(bar)<br></br>endef</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp132992")' id="imgidp132992"></img><a id="FMFreemind_Link_1943340349FM"></a><div class="nodecontent">例如:</div><div class="content" id="idp132992"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_660990854FM"></a><div class="nodecontent">define run-yacc<br></br>yacc $(firstword $^)<br></br>mv y.tab.c $@<br></br>endef<br></br><br></br>foo.c : foo.y<br></br>	$(run-yacc)<br></br><br></br> 
</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp135200")' id="imgidp135200"></img><a id="FMFreemind_Link_1194961894FM"></a><div class="nodecontent">5-5. 注释</div><div class="content" id="idp135200"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1493698346FM"></a><div class="nodecontent"># 注释一行，\# 代表真正的 井号</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1409032795FM"></a><div class="nodecontent"># 注释行最后的 \ 字符，将会使下一行也成为注释</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp137920")' id="imgidp137920"></img><a id="FMFreemind_Link_1928202575FM"></a><div class="nodecontent">规则中的命令</div><div class="content" id="idp137920"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp138928")' id="imgidp138928"></img><a id="FMFreemind_Link_709443633FM"></a><div class="nodecontent">TAB 字符</div><div class="content" id="idp138928"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1635005626FM"></a><div class="nodecontent">除了第一行命令可以于 target-and-prerequisites 同一行，用分号分隔外，都要在行首用 Tab 缩进。</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_690330439FM"></a><div class="nodecontent">注释和空行被忽略。但要注意所谓空行，也要有一个 TAB 起始！</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_984112828FM"></a><div class="nodecontent">条件指令不需要 有 Tab 起始？</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp142528")' id="imgidp142528"></img><a id="FMFreemind_Link_999377850FM"></a><div class="nodecontent">@ 字符</div><div class="content" id="idp142528"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1175078275FM"></a><div class="nodecontent">执行命令，但不显示命令本身。@ 字符脱掉之后，传递给 Shell 执行</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_642093085FM"></a><div class="nodecontent">make -s/--silent 可以起到同样效果</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp145264")' id="imgidp145264"></img><a id="FMFreemind_Link_1826979715FM"></a><div class="nodecontent">\ 续行符</div><div class="content" id="idp145264"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1208615686FM"></a><div class="nodecontent">位于行尾的 \ ，作为续行符</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp147168")' id="imgidp147168"></img><a id="FMFreemind_Link_633844672FM"></a><div class="nodecontent">cd 目录的作用范围</div><div class="content" id="idp147168"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1042983203FM"></a><div class="nodecontent">cd命令，改变目录，不会影响后续命令的路径</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1479860837FM"></a><div class="nodecontent">除非和 cd 命令处于同一行，用分号分开</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp149904")' id="imgidp149904"></img><a id="FMFreemind_Link_1444533563FM"></a><div class="nodecontent">- 忽略错误</div><div class="content" id="idp149904"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1955757405FM"></a><div class="nodecontent">在 TAB 之后的减号 -， 将忽略该命令的错误</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp151696")' id="imgidp151696"></img><a id="FMFreemind_Link_487648516FM"></a><div class="nodecontent">如: </div><div class="content" id="idp151696"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1375149018FM"></a><div class="nodecontent">  clean:<br></br>        -rm -f *.o</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp153840")' id="imgidp153840"></img><a id="FMFreemind_Link_1456050159FM"></a><div class="nodecontent">特殊目标：all</div><div class="content" id="idp153840"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1853125673FM"></a><div class="nodecontent">执行 make 如果不指定目标，将执行第一个目标</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1898029060FM"></a><div class="nodecontent">多目标 Makefile，则可以将第一个目标定为 all，将其它目标作为其依赖，这样就可以执行所有目标编译，并指定编译顺序。</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp156912")' id="imgidp156912"></img><a id="FMFreemind_Link_513150113FM"></a><div class="nodecontent">Phony Targets</div><div class="content" id="idp156912"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp157904")' id="imgidp157904"></img><a id="FMFreemind_Link_1250414817FM"></a><div class="nodecontent">clean:<br></br>        rm *.o temp</div><div class="content" id="idp157904"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_815187252FM"></a><div class="nodecontent">clean 这样的 target 本身没有任何依赖，<br></br>如果目录中存在名为 clean 的文件，则<br></br>不再执行，因为认为 clean 的状态是更新的。</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp159936")' id="imgidp159936"></img><a id="FMFreemind_Link_158406446FM"></a><div class="nodecontent">.PHONY : clean </div><div class="content" id="idp159936"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_861226530FM"></a><div class="nodecontent">将 clean 加入 .PHONY ，则 clean 的执行不会收到存在同名文件的影响</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp161760")' id="imgidp161760"></img><a id="FMFreemind_Link_153093299FM"></a><div class="nodecontent">.PHONY : all clean</div><div class="content" id="idp161760"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1452277526FM"></a><div class="nodecontent">像 all 这样拥有依赖目标的，也可以加入到 phony 中</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp163616")' id="imgidp163616"></img><a id="FMFreemind_Link_294661125FM"></a><div class="nodecontent">.PHONY 的替代方案 "FORCE"</div><div class="content" id="idp163616"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp164624")' id="imgidp164624"></img><a id="FMFreemind_Link_1976864543FM"></a><div class="nodecontent">如: </div><div class="content" id="idp164624"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_389933549FM"></a><div class="nodecontent">clean: FORCE<br></br>        rm $(objects)<br></br>FORCE:</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_556078736FM"></a><div class="nodecontent">有的 make 不支持 .PHONY，则可以定义一个不存在的目标，没有任何依赖，也没有任何命令，如 FORCE:</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1178924073FM"></a><div class="nodecontent">FORCE 因为不存在，且没有任何依赖，其本身如果被当做依赖，则相应的目标必然执行。起到了 .PHONY 的作用</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp169520")' id="imgidp169520"></img><a id="FM_FM"></a><div class="nodecontent">函数</div><div class="content" id="idp169520"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp170592")' id="imgidp170592"></img><a id="FMFreemind_Link_294761510FM"></a><div class="nodecontent">格式</div><div class="content" id="idp170592"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1984202538FM"></a><div class="nodecontent">$(function arguments)   或者  ${function arguments}     </div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_969722718FM"></a><div class="nodecontent">function 和 arguments 之间空格分开</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1138536329FM"></a><div class="nodecontent">各个 argument 之间用冒号分开</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp173984")' id="imgidp173984"></img><a id="FMFreemind_Link_1734805802FM"></a><div class="nodecontent">字符串函数</div><div class="content" id="idp173984"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp174976")' id="imgidp174976"></img><a id="FMFreemind_Link_59583942FM"></a><div class="nodecontent">替换</div><div class="content" id="idp174976"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp175968")' id="imgidp175968"></img><a id="FMFreemind_Link_730005907FM"></a><div class="nodecontent">$(subst from,to,text) </div><div class="content" id="idp175968"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1886584189FM"></a><div class="nodecontent">子串替换。$(subst from,to,text) ，将 text 中出现的 from 用 to 替换</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1693939686FM"></a><div class="nodecontent">$(subst ee,EE,feet on the street)  </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp178720")' id="imgidp178720"></img><a id="FMFreemind_Link_592325206FM"></a><div class="nodecontent">$(patsubst pattern,replacement,text) </div><div class="content" id="idp178720"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1068821866FM"></a><div class="nodecontent">$(patsubst %.c,%.o,x.c.c bar.c)  </div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp180784")' id="imgidp180784"></img><a id="FMFreemind_Link_1379539309FM"></a><div class="nodecontent">去掉首尾空格</div><div class="content" id="idp180784"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp181792")' id="imgidp181792"></img><a id="FMFreemind_Link_1268310006FM"></a><div class="nodecontent">$(strip string) </div><div class="content" id="idp181792"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_194322825FM"></a><div class="nodecontent">.PHONY: all<br></br>ifneq   $(strip $(needs_made))  ""<br></br>all: $(needs_made)<br></br>else<br></br>all:;@echo 'Nothing to make!'<br></br>endif</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp184128")' id="imgidp184128"></img><a id="FMFreemind_Link_1539062174FM"></a><div class="nodecontent">查找、过滤</div><div class="content" id="idp184128"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp184992")' id="imgidp184992"></img><a id="FMFreemind_Link_99487815FM"></a><div class="nodecontent">$(findstring find,in)</div><div class="content" id="idp184992"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1377061704FM"></a><div class="nodecontent">找到，则返回 find, 否则返回空串</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp186688")' id="imgidp186688"></img><a id="FMFreemind_Link_1948816622FM"></a><div class="nodecontent">如：</div><div class="content" id="idp186688"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_644373541FM"></a><div class="nodecontent"><br></br> $(findstring a,a b c)<br></br>$(findstring a,b c)</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp188720")' id="imgidp188720"></img><a id="FMFreemind_Link_1367043180FM"></a><div class="nodecontent">$(filter pattern...,text) </div><div class="content" id="idp188720"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1211123542FM"></a><div class="nodecontent">在 text 中查找匹配 pattern（可为多个）的单词</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp190528")' id="imgidp190528"></img><a id="FMFreemind_Link_772962635FM"></a><div class="nodecontent">如：</div><div class="content" id="idp190528"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_287359314FM"></a><div class="nodecontent">sources := foo.c bar.c baz.s ugh.h<br></br>foo: $(sources)<br></br>	cc $(filter %.c %.s,$(sources)) -o foo</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp192608")' id="imgidp192608"></img><a id="FMFreemind_Link_1656809828FM"></a><div class="nodecontent">$(filter-out pattern...,text) </div><div class="content" id="idp192608"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1344715301FM"></a><div class="nodecontent">和 filter 函数相反，在 text 中查找除了 pattern（可为多个）之外的单词</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp194672")' id="imgidp194672"></img><a id="FMFreemind_Link_1556672899FM"></a><div class="nodecontent">如：</div><div class="content" id="idp194672"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_299245748FM"></a><div class="nodecontent">objects=main1.o foo.o main2.o bar.o<br></br>mains=main1.o main2.o<br></br><br></br>$(filter-out $(mains),$(objects))</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp196880")' id="imgidp196880"></img><a id="FMFreemind_Link_1700277573FM"></a><div class="nodecontent">排序、次序</div><div class="content" id="idp196880"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp197744")' id="imgidp197744"></img><a id="FMFreemind_Link_1125443152FM"></a><div class="nodecontent">$(sort list) </div><div class="content" id="idp197744"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_680807085FM"></a><div class="nodecontent">如：   $(sort foo bar lose) </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp199536")' id="imgidp199536"></img><a id="FMFreemind_Link_269129231FM"></a><div class="nodecontent">$(words text) </div><div class="content" id="idp199536"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_827221980FM"></a><div class="nodecontent">返回 text 中单词数量</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp201424")' id="imgidp201424"></img><a id="FMFreemind_Link_1041555472FM"></a><div class="nodecontent">$(word n,text) </div><div class="content" id="idp201424"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1690114181FM"></a><div class="nodecontent">返回 text 中第几个单词，从1开始</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1458826302FM"></a><div class="nodecontent">$(word 2, foo bar baz)  </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp204096")' id="imgidp204096"></img><a id="FMFreemind_Link_882168859FM"></a><div class="nodecontent">$(wordlist s,e,text) </div><div class="content" id="idp204096"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_158306977FM"></a><div class="nodecontent">返回 text 中第s个到第e个单词</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_674133342FM"></a><div class="nodecontent">$(wordlist 2, 3, foo bar baz)  </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp206784")' id="imgidp206784"></img><a id="FMFreemind_Link_1288657702FM"></a><div class="nodecontent">$(firstword names...) </div><div class="content" id="idp206784"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1211013292FM"></a><div class="nodecontent">返回第一个单词</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp208560")' id="imgidp208560"></img><a id="FMFreemind_Link_1646905403FM"></a><div class="nodecontent">例如：测试 DocBook XSLT 引擎</div><div class="content" id="idp208560"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_431905618FM"></a><div class="nodecontent"># XSLT=java \<br></br>    -Djavax.xml.parsers.DocumentBuilderFactory=org.apache.xerces.jaxp.DocumentBuilderFactoryImpl \<br></br>    ...<br></br>XSLT=/usr/bin/xsltproc --nonet --timing<br></br><br></br>ifeq ($(notdir $(firstword $(XSLT))),xsltproc)<br></br>...<br></br>else<br></br>...<br></br>endif</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp211232")' id="imgidp211232"></img><a id="FMFreemind_Link_1957051421FM"></a><div class="nodecontent">联合</div><div class="content" id="idp211232"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1665348531FM"></a><div class="nodecontent">$(join list1,list2) </div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp212960")' id="imgidp212960"></img><a id="FMFreemind_Link_1620387223FM"></a><div class="nodecontent">文件名函数</div><div class="content" id="idp212960"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp213952")' id="imgidp213952"></img><a id="FMFreemind_Link_1082202467FM"></a><div class="nodecontent">$(dir names...) </div><div class="content" id="idp213952"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp214960")' id="imgidp214960"></img><a id="FMFreemind_Link_1019296301FM"></a><div class="nodecontent">返回的目录名包括最后的斜杠</div><div class="content" id="idp214960"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_351806846FM"></a><div class="nodecontent">如： $(dir src/foo.c hacks)  </div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp217008")' id="imgidp217008"></img><a id="FMFreemind_Link_731952506FM"></a><div class="nodecontent">$(notdir names...) </div> <a onclick="getVisibleParents('FMFreemind_Link_731952506FM')" href="#FMFreemind_Link_731952506FM"><img src="/docbook/includes/images/freemind/ilink.png" class="ilink" alt="Arrow Link"></img></a><div class="content" id="idp217008"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp219744")' id="imgidp219744"></img><a id="FMFreemind_Link_817371731FM"></a><div class="nodecontent">返回文件名</div><div class="content" id="idp219744"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1329727880FM"></a><div class="nodecontent">如：  $(notdir src/foo.c hacks)   </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_187388712FM"></a><div class="nodecontent">例如</div> <a onclick="getVisibleParents('FMFreemind_Link_1646905403FM')" href="#FMFreemind_Link_1646905403FM"><img src="/docbook/includes/images/freemind/ilink.png" class="ilink" alt="Arrow Link"></img></a></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp224384")' id="imgidp224384"></img><a id="FMFreemind_Link_1184660214FM"></a><div class="nodecontent">$(suffix names...) </div><div class="content" id="idp224384"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp225392")' id="imgidp225392"></img><a id="FMFreemind_Link_899276150FM"></a><div class="nodecontent">返回文件扩展名</div><div class="content" id="idp225392"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_28484300FM"></a><div class="nodecontent">如：$(suffix src/foo.c src-1.0/bar.c hacks)   返回 .c .c</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp227456")' id="imgidp227456"></img><a id="FMFreemind_Link_1907384195FM"></a><div class="nodecontent">$(basename names...) </div><div class="content" id="idp227456"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1582103607FM"></a><div class="nodecontent" style="font-size:100%;font-weight:bold;">注意：此 basename 和 shell 的 basename 不同！返回去掉扩展名之后的文件名包含目录名。</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1658853306FM"></a><div class="nodecontent"> $(basename src/foo.c src-1.0/bar hacks) 返回 src/foo src-1.0/bar hacks</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp231440")' id="imgidp231440"></img><a id="FMFreemind_Link_449536649FM"></a><div class="nodecontent">$(addsuffix suffix,names...) </div><div class="content" id="idp231440"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_339495661FM"></a><div class="nodecontent">为文件增加扩展名</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_388830432FM"></a><div class="nodecontent">$(addsuffix .c,foo bar) </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp234016")' id="imgidp234016"></img><a id="FMFreemind_Link_839802633FM"></a><div class="nodecontent">$(addprefix prefix,names...) </div><div class="content" id="idp234016"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_406286776FM"></a><div class="nodecontent">增加前缀</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_473813292FM"></a><div class="nodecontent">$(addprefix src/,foo bar)  </div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1456427921FM"></a><div class="nodecontent">$(join list1,list2) </div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp237440")' id="imgidp237440"></img><a id="FMFreemind_Link_101891168FM"></a><div class="nodecontent" style="font-size:100%;font-weight:bold;">$(wildcard pattern) </div><div class="content" id="idp237440"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1664110605FM"></a><div class="nodecontent">展开通配符</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp240160")' id="imgidp240160"></img><a id="FMFreemind_Link_1541011900FM"></a><div class="nodecontent">例如</div><div class="content" id="idp240160"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_698769618FM"></a><div class="nodecontent">ALL_SOURCE := $(wildcard $(XML_SRCDIR)/*.xml)<br></br>ALL_SOURCE := $(filter-out $(VERSION_SOURCE),$(ALL_SOURCE))<br></br><br></br># 如果不用 wildcard， $(ALL_SOURCE) 依然是 *.xml ，仍然包括 version.xml，造成循环依赖<br></br>$(VERSION_SOURCE) : $(ALL_SOURCE)<br></br>	... ...</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp242704")' id="imgidp242704"></img><a id="FMFreemind_Link_1725336706FM"></a><div class="nodecontent">foreach</div><div class="content" id="idp242704"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_150662886FM"></a><div class="nodecontent">find_files = $(wildcard $(dir)/*)<br></br>dirs := a b c d<br></br>files := $(foreach dir,$(dirs),$(find_files))<br></br><br></br>等价于<br></br><br></br>files := $(wildcard a/* b/* c/* d/*)</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp244768")' id="imgidp244768"></img><a id="FMFreemind_Link_463985322FM"></a><div class="nodecontent">call</div><div class="content" id="idp244768"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp245760")' id="imgidp245760"></img><a id="FMFreemind_Link_1030009919FM"></a><div class="nodecontent">如：</div><div class="content" id="idp245760"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_129482149FM"></a><div class="nodecontent">reverse = $(2) $(1)<br></br>foo = $(call reverse,a,b)</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_477911953FM"></a><div class="nodecontent">pathsearch = $(firstword $(wildcard $(addsuffix /$(1),$(subst :, ,$(PATH)))))<br></br>LS := $(call pathsearch,ls)</div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_125721421FM"></a><div class="nodecontent">map = $(foreach a,$(2),$(call $(1),$(a)))<br></br>o = $(call map,origin,o map MAKE)</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp249328")' id="imgidp249328"></img><a id="FMFreemind_Link_1848148367FM"></a><div class="nodecontent">origin</div><div class="content" id="idp249328"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1174150831FM"></a><div class="nodecontent">$(origin variable)  </div></div><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_940846032FM"></a><div class="nodecontent">查看变量  variable 的来源，variable 不要带 $。<br></br>返回值：undefined，default，environment，environment override，<br></br>command line，override，automatic</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp252128")' id="imgidp252128"></img><a id="FMFreemind_Link_1381078834FM"></a><div class="nodecontent">如: DocBook Makefile 测试环境变量 XML_CATALOG_FILES</div><div class="content" id="idp252128"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1568983020FM"></a><div class="nodecontent">docbook.test:<br></br>ifeq "$(XML_CATALOG_FILES)" ""<br></br>	$(error XML_CATALOG_FILES is blank!)<br></br>endif<br></br>ifeq "$(origin XML_CATALOG_FILES)" "undefined"<br></br>	$(error XML_CATALOG_FILES is $(origin XML_CATALOG_FILES) !)<br></br>endif
</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp255136")' id="imgidp255136"></img><a id="FMFreemind_Link_1121935112FM"></a><div class="nodecontent">SHELL 函数</div><div class="content" id="idp255136"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp255936")' id="imgidp255936"></img><a id="FMFreemind_Link_714606345FM"></a><div class="nodecontent">如</div><div class="content" id="idp255936"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1638965363FM"></a><div class="nodecontent">contents := $(shell cat foo)<br></br>files := $(shell echo *.c)</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp257824")' id="imgidp257824"></img><a id="FMFreemind_Link_1075418567FM"></a><div class="nodecontent">出错处理函数</div><div class="content" id="idp257824"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp258816")' id="imgidp258816"></img><a id="FMFreemind_Link_1929973967FM"></a><div class="nodecontent">$(error text...) </div><div class="content" id="idp258816"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1848284693FM"></a><div class="nodecontent">显示异常，并退出</div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp260592")' id="imgidp260592"></img><a id="FMFreemind_Link_1533642396FM"></a><div class="nodecontent">如: DocBook Makefile 测试环境变量 XML_CATALOG_FILES</div><div class="content" id="idp260592"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_310417428FM"></a><div class="nodecontent">docbook.test:<br></br>ifeq "$(XML_CATALOG_FILES)" ""<br></br>	$(error XML_CATALOG_FILES is blank!)<br></br>endif<br></br>ifeq "$(origin XML_CATALOG_FILES)" "undefined"<br></br>	$(error XML_CATALOG_FILES is $(origin XML_CATALOG_FILES) !)<br></br>endif
</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp263008")' id="imgidp263008"></img><a id="FMFreemind_Link_204775136FM"></a><div class="nodecontent">$(warning text...) </div><div class="content" id="idp263008"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_833441888FM"></a><div class="nodecontent">显示警告，不退出</div></div></div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp265104")' id="imgidp265104"></img><a id="FMFreemind_Link_1262902379FM"></a><div class="nodecontent">诊断、调试</div><div class="content" id="idp265104"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp266224")' id="imgidp266224"></img><a id="FMFreemind_Link_1183618005FM"></a><div class="nodecontent">make -n</div><div class="content" id="idp266224"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_417709776FM"></a><div class="nodecontent">不执行命令，只是显示每条命令的执行</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp268144")' id="imgidp268144"></img><a id="FMFreemind_Link_1843934833FM"></a><div class="nodecontent">@echo ...</div><div class="content" id="idp268144"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_634274853FM"></a><div class="nodecontent">打印消息</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp270016")' id="imgidp270016"></img><a id="FMFreemind_Link_1669194261FM"></a><div class="nodecontent">$(error text...) </div><div class="content" id="idp270016"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_581662703FM"></a><div class="nodecontent">显示异常，并退出</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp271920")' id="imgidp271920"></img><a id="FMFreemind_Link_1999701553FM"></a><div class="nodecontent">$(warning text...) </div><div class="content" id="idp271920"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1882277530FM"></a><div class="nodecontent">显示警告，不退出</div></div></div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp273952")' id="imgidp273952"></img><a id="FMFreemind_Link_679529586FM"></a><div class="nodecontent">Makefile Samples</div><div class="content" id="idp273952"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1067554209FM"></a><div class="nodecontent">WHODO DocBook Makefile(s)</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp276096")' id="imgidp276096"></img><a id="FMFreemind_Link_548693933FM"></a><div class="nodecontent">关于本文</div><div class="content" id="idp276096"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp277328")' id="imgidp277328"></img><a id="FMFreemind_Link_182605449FM"></a><div class="nodecontent">版本</div><div class="content" id="idp277328"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1909676368FM"></a><div class="nodecontent">v0.1 at 2005/08</div></div></div></div><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp279200")' id="imgidp279200"></img><a id="FMFreemind_Link_827462667FM"></a><div class="nodecontent">作者</div><div class="content" id="idp279200"><div class="node"><img src="/docbook/includes/images/freemind/hide.png" class="hideshow" alt="hide" onClick='toggle("idp280192")' id="imgidp280192"></img><a id="FMFreemind_Link_306056730FM"></a><div class="nodecontent">J</div><div class="content" id="idp280192"><div class="node"><img src="/docbook/includes/images/freemind/leaf.png" class="hideshow" alt="leaf"></img><a id="FMFreemind_Link_1139513322FM"></a><div class="nodecontent">Jiang Xin</div></div></div></div></div></div></div></div></div></div><script type="text/javascript" src="/docbook/includes/js/footer.js"></script><script type="text/javascript">
	  write_footer("/docbook");
	</script></body></html>
